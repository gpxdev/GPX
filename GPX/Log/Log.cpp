#include "Log.h"

#include <ctime>
#include <fstream>

namespace std
{

//////////////////////////////////////////////////////////////////////////////////////////////

ofstream* Log::s_logFile = nullptr;
	
//////////////////////////////////////////////////////////////////////////////////////////////

Log::Log()
{
	s_logFile = new std::ofstream("RuntimeLog.txt");
}

//////////////////////////////////////////////////////////////////////////////////////////////

Log::~Log()
{
	if (s_logFile != nullptr)
		s_logFile->close();
	delete s_logFile;
}

//////////////////////////////////////////////////////////////////////////////////////////////

Log& Log::getInstance()
{
	static Log instance;
	return instance;
}

//////////////////////////////////////////////////////////////////////////////////////////////

void Log::writeWarning(const char* logMessage)
{
	if (s_logFile != nullptr)
	{
		*s_logFile << getFormattedTime() << " - " << "Warning: " << logMessage << std::endl;
	}
}

//////////////////////////////////////////////////////////////////////////////////////////////

void Log::writeError(const char* logMessage)
{
	if (s_logFile != nullptr)
	{
		*s_logFile << getFormattedTime() << " - " << "Error: "  << logMessage << std::endl;
	}
}

//////////////////////////////////////////////////////////////////////////////////////////////

const char* Log::getFormattedTime()
{
	time_t result;
	time(&result);
	string timeString = ctime(&result);
	if (!timeString.empty())
		timeString = timeString.substr(0, timeString.length() - 1);
	
	return timeString.c_str();
}

} // namespace std
